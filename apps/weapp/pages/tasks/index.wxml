<view class="container task-page">
  <view class="header">
    <view class="title">{{i18n.title}}</view>
    <view class="subtitle">{{i18n.createAndProcrastinate}}</view>
  </view>

  <!-- æ·»åŠ ä»»åŠ¡å¡ç‰‡ï¼ˆVantï¼‰ -->
  <view class="card card-add shadow-md">
    <text class="section-title section-title-add">{{i18n.addTask}}</text>
    <van-field class="add-input" value="{{inputValue}}" placeholder="{{i18n.whatToProcrastinate || ''}}" border="{{false}}" bind:change="onVanFieldChange" bind:confirm="onVanFieldConfirm" />
    <view class="add-actions">
      <van-button block type="primary" color="#93c5fd" round size="small" bind:tap="onAddTask">ï¼‹ {{i18n.addTask}}</van-button>
    </view>
  </view>

  <!-- å¾…åŠåˆ—è¡¨ä¸ç©ºçŠ¶æ€ -->
  <view class="section">
    <view class="row space-between">
      <text class="section-title">{{i18n.pending}} ({{todo.length}})</text>
    </view>

    <!-- ç©ºçŠ¶æ€å¡ç‰‡ï¼ˆå¯¹é½ Web æ–‡æ¡ˆï¼‰ -->
    <block wx:if="{{!todo.length}}">
      <view class="card shadow-md empty-card">
        <text class="empty-title">{{i18n.noTasksToday || 'ä»Šå¤©è¿˜æ²¡æœ‰ä»»åŠ¡ï¼Œå¿«æ¥åˆ›å»ºä¸€ä¸ªå§ï¼'}}</text>
        <text class="empty-sub muted">{{i18n.procrastinationStarts || 'æ‹–å»¶ä»åˆ›å»ºä»»åŠ¡å¼€å§‹ï½'}}</text>
      </view>
      <view class="card card-gradient shadow-md tip-card">
        <text class="tip-title">{{i18n.feelingFreeToday || 'ä»Šå¤©æ„Ÿè§‰å¾ˆè½»æ¾ï¼Ÿ'}}</text>
        <text class="tip-sub muted">{{i18n.createToStartProcrastination || 'åˆ›å»ºä¸€äº›ä»»åŠ¡ï¼Œå¼€å§‹æ‚¨çš„æ‹–å»¶ä¹‹æ—…ï¼'}}</text>
        <text class="tip-sub muted">{{i18n.procrastinationQuote || 'è®°ä½ï¼šæ‹–å»¶ä¸æ˜¯æ‡’æƒ°ï¼Œè€Œæ˜¯é«˜çº§æ—¶é—´ç®¡ç† ğŸ˜'}}</text>
      </view>
    </block>

    <!-- åˆ—è¡¨ï¼ˆå¡ç‰‡å¼ï¼‰ -->
    <view wx:if="{{todo.length>0}}" class="hint">{{tasksWaitingText}}</view>
    <block wx:for="{{todoView}}" wx:key="id">
      <view class="task-card">
        <view class="row space-between">
          <view>
            <text class="task-name">{{item.name}}</text>
            <text class="task-sub">{{i18n.createdAtOn.replace('{date}', item.createdShort)}}</text>
          </view>
          <view class="delete-icon" data-id="{{item.id}}" bind:tap="onDelete">ğŸ—‘</view>
        </view>
        <view class="cell-actions two-col">
          <van-button size="small" type="warning" plain round bind:tap="onDelay" data-id="{{item.id}}">{{i18n.delayed}}</van-button>
          <van-button size="small" color="#16a34a" round bind:tap="onComplete" data-id="{{item.id}}">{{i18n.finish}}</van-button>
        </view>
      </view>
    </block>
  </view>

  <!-- å·²å®ŒæˆæŠ˜å åŒºï¼ˆVantï¼‰ -->
  <view class="section" wx:if="{{completed.length>0}}">
    <view class="row space-between">
      <text class="section-title">{{i18n.completed}} ({{completed.length}})</text>
      <van-button type="default" plain size="mini" bind:tap="toggleCompleted">{{isCompletedExpanded? 'â–² ' + i18n.collapse : 'â–¼ ' + i18n.expand}}</van-button>
    </view>
    <view wx:if="{{isCompletedExpanded}}">
      <view class="hint">{{i18n.completionSatisfaction}}</view>
      <van-cell-group inset>
        <block wx:for="{{completedView}}" wx:key="id">
          <van-cell use-title-slot use-label-slot>
            <view slot="title" class="cell-title completed">{{item.name}}</view>
            <view slot="label" class="cell-label">
              <text class="muted">{{'å®Œæˆäº ' + item.createdShort}}</text>
              <van-tag class="completed-tag" type="success" plain round>
                <van-icon name="success" size="14" color="#16a34a" /> å·²å®Œæˆ
              </van-tag>
            </view>
          </van-cell>
        </block>
      </van-cell-group>
    </view>
  </view>
</view>
