# i love delay ğŸŒ

ä¸€ä¸ªåå‘ä»»åŠ¡ç®¡ç†åº”ç”¨ - é¼“åŠ±æ‹–å»¶ï¼Œå¥–åŠ±å€Ÿå£ï¼

> "æ‹–å»¶ä¸æ˜¯ç—…ï¼Œæ˜¯ä¸€ç§ç”Ÿæ´»æ€åº¦" - i love delay

## ğŸ¯ é¡¹ç›®ç®€ä»‹

i love delay æ˜¯ä¸€ä¸ªä¸“ä¸ºæ‹–å»¶ç—‡æ‚£è€…è®¾è®¡çš„ä»»åŠ¡ç®¡ç†åº”ç”¨ã€‚ä¸ä¼ ç»Ÿä»»åŠ¡ç®¡ç†ä¸åŒï¼Œæˆ‘ä»¬é¼“åŠ±ä½ æ‹–å»¶ä»»åŠ¡ï¼Œå¹¶ä¸ºæ¯ä¸ªæ‹–å»¶çš„ä»»åŠ¡æä¾›åˆ›æ„å€Ÿå£ã€‚

### æ ¸å¿ƒç‰¹è‰²
- ğŸ­ **é¼“åŠ±æ‹–å»¶**ï¼šä¸å®Œæˆä»»åŠ¡åè€Œè·å¾—å¥–åŠ±
- ğŸ“ **åˆ›æ„å€Ÿå£**ï¼šä¸ºæ¯ä¸ªæ‹–å»¶ä»»åŠ¡å†™æœ‰è¶£å€Ÿå£
- ğŸ“Š **æ‹–å»¶ç»Ÿè®¡**ï¼šåˆ†æä½ çš„æ‹–å»¶æ¨¡å¼å’Œä¹ æƒ¯
- âš¡ **æš´èµ°æ¨¡å¼**ï¼šçªå‡»å®Œæˆå †ç§¯çš„ä»»åŠ¡
- ğŸ“± **ç§»åŠ¨ä¼˜å…ˆ**ï¼šå®Œç¾é€‚é…æ‰‹æœºä½¿ç”¨åœºæ™¯

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- npm

### å®‰è£…ä¾èµ–
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/i-love-delay.git
cd i-love-delay

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### è®¿é—®åº”ç”¨
æ‰“å¼€ [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

 - **Next.js 15.5.2**ï¼ˆApp Routerï¼‰
 - **React 19.1.0** ä¸ **TypeScript 5.9.2**
 - **Tailwind CSS 4.x**ï¼ˆ^4.1.12ï¼‰ä¸ **@tailwindcss/postcss**
 - **next-intl 4.x**ï¼ˆå›½é™…åŒ–ä¸æœ¬åœ°åŒ–è·¯ç”±ï¼‰
 - **PostgreSQLï¼ˆè‡ªå»ºï¼‰+ pg**ï¼ˆé€šè¿‡ Next.js API è·¯ç”±åœ¨æœåŠ¡ç«¯è®¿é—®ï¼‰
 - **Dexie 4.x**ï¼ˆIndexedDB å°è£…ï¼Œæœ¬åœ°æ•°æ®ï¼‰
 - **Zustand 5.x**ï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
 - **Radix UI + shadcn é£æ ¼ç»„ä»¶**ï¼ˆè§ `src/components/ui/`ï¼‰
 - **TanStack Query 5.x**ï¼ˆæ•°æ®è·å–/ç¼“å­˜ï¼‰
 - **Lucide React**ï¼ˆå›¾æ ‡ï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„

```
i-love-delay/
â”œâ”€â”€ src/
â”‚  â”œâ”€â”€ app/
â”‚  â”‚  â”œâ”€â”€ [locale]/                 # æœ¬åœ°åŒ–è·¯ç”±ï¼ˆé»˜è®¤ zhï¼‰
â”‚  â”‚  â”‚  â”œâ”€â”€ api/                   # æœåŠ¡å™¨ç«¯ API è·¯ç”±ï¼ˆPostgreSQLï¼‰
â”‚  â”‚  â”‚  â”œâ”€â”€ delayed/               # æ‹–å»¶é¡µ
â”‚  â”‚  â”‚  â”œâ”€â”€ rage/                  # æš´èµ°é¡µ
â”‚  â”‚  â”‚  â”œâ”€â”€ square/                # å¹¿åœºé¡µï¼ˆåˆ†äº«/å‘ç°ï¼‰
â”‚  â”‚  â”‚  â”œâ”€â”€ profile/               # ä¸ªäººé¡µ
â”‚  â”‚  â”‚  â”œâ”€â”€ layout.tsx             # i18n Provider + AppProvider
â”‚  â”‚  â”‚  â””â”€â”€ page.tsx               # é¦–é¡µï¼ˆä»»åŠ¡åˆ—è¡¨ï¼‰
â”‚  â”‚  â”œâ”€â”€ favicon.ico
â”‚  â”‚  â””â”€â”€ globals.css
â”‚  â”œâ”€â”€ components/                  # åŸºäº Radix/shadcn é£æ ¼çš„ç»„ä»¶ç­‰
â”‚  â”œâ”€â”€ i18n/
â”‚  â”‚  â””â”€â”€ request.ts                # next-intl è¯·æ±‚é…ç½®
â”‚  â”œâ”€â”€ lib/
â”‚  â”‚  â”œâ”€â”€ server/                   # æœåŠ¡å™¨ç«¯å·¥å…·ï¼ˆpg è¿æ¥æ± ç­‰ï¼‰
â”‚  â”‚  â”œâ”€â”€ stores/                   # Zustand storesï¼ˆä»»åŠ¡/å€Ÿå£/UI/è®¤è¯ï¼‰
â”‚  â”‚  â””â”€â”€ i18n/                     # i18n é…ç½®
â”‚  â””â”€â”€ messages/
â”‚     â”œâ”€â”€ zh.json                   # ä¸­æ–‡æ–‡æ¡ˆ
â”‚     â””â”€â”€ en.json                   # è‹±æ–‡æ–‡æ¡ˆ
â”œâ”€â”€ db/
â”‚  â””â”€â”€ migrations/
â”‚     â””â”€â”€ 0001_init.sql             # æ•°æ®åº“ç»“æ„ä¸ç¤ºä¾‹
â”œâ”€â”€ deploy/
â”‚  â”œâ”€â”€ nginx.site.template.conf     # Nginx æ¨¡æ¿ï¼ˆå« /_next/static aliasï¼‰
â”‚  â””â”€â”€ supervisor.program.template.conf # Supervisor æ¨¡æ¿ï¼ˆstandaloneï¼‰
â”œâ”€â”€ scripts/
â”‚  â””â”€â”€ kill-port-3000.js            # è·¨å¹³å°æ¸…ç† 3000 ç«¯å£
â”œâ”€â”€ messages/                        # æ–‡æ¡ˆå­—å…¸ï¼ˆä¾› next-intl åŠ è½½ï¼‰
â”œâ”€â”€ next.config.ts                   # output: 'standalone'
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ eslint.config.mjs
â”œâ”€â”€ package.json
â”œâ”€â”€ postcss.config.mjs
â””â”€â”€ README.md
```

## ğŸ› ï¸ å¼€å‘å‘½ä»¤

```bash
# å¼€å‘ï¼ˆè‡ªåŠ¨æ¸…ç† 3000 ç«¯å£åå¯åŠ¨ Next å¼€å‘æœåŠ¡å™¨ï¼‰
npm run dev

# æ„å»ºç”Ÿäº§
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡
npm run start

# ä»£ç æ£€æŸ¥ï¼ˆESLint 9 + Next é…ç½®ï¼‰
npm run lint

# æ‰‹åŠ¨æ¸…ç†ç«¯å£ï¼ˆWindows/macOS/Linux å‡å¯ï¼‰
npm run kill-port
```

è¯´æ˜ï¼š`scripts/kill-port-3000.js` ä¼šåœ¨ `npm run dev` å‰è‡ªåŠ¨æ‰§è¡Œï¼Œæ¸…ç†å ç”¨ 3000 ç«¯å£çš„è¿›ç¨‹ï¼Œé¿å…ç«¯å£å†²çªã€‚

## ğŸ›³ éƒ¨ç½²

### è‡ªå»ºéƒ¨ç½²ï¼ˆstandalone + Supervisor + Nginxï¼‰

æ¨èä½¿ç”¨å†…ç½®çš„ `deploy.sh` è„šæœ¬åœ¨æœ¬åœ°å®Œæˆæ„å»ºå¹¶ä»…ä¸Šä¼ äº§ç‰©ï¼š

1) åœ¨é¡¹ç›®æ ¹ç›®å½•é…ç½® `.env.local`ï¼š

```dotenv
SERVER=your.server.ip.or.domain
SSH_USER=deployer
REMOTE_DIR=/var/www/delay.bebackpacker.com
SUPERVISOR=delay.bebackpacker.com
DEPLOY_PORT=3002
```

2) æœåŠ¡å™¨ä¸Šå‡†å¤‡ï¼š

- åœ¨ `REMOTE_DIR` æ”¾ç½® `.env`ï¼ˆè¿è¡ŒæœŸç¯å¢ƒå˜é‡ï¼ŒåŒ…å« `DATABASE_URL`ï¼‰ã€‚
- ä¸º `deployer` é…ç½®å…å¯† `sudo supervisorctl`ï¼ˆè§ `docs/deployment-self-hosted.md`ï¼‰ã€‚
- æŒ‰æ¨¡æ¿åˆ›å»º Supervisor é…ç½®ï¼Œä½¿ç”¨ `node .next/standalone/server.js` å¯åŠ¨ï¼Œå¹¶å°†æ—¥å¿—å†™å…¥ `${REMOTE_DIR}/logs/`ã€‚

3) æœ¬åœ°æ‰§è¡Œï¼š

```bash
./deploy.sh
# é€‰æ‹© 2) server - è¿œç¨‹éƒ¨ç½²ï¼ˆæœ¬åœ°æ„å»º standaloneï¼Œä¸Šä¼ äº§ç‰©ï¼ŒSupervisor é‡å¯ï¼‰
```

4) Nginxï¼š

ä¸ºé¿å…é™æ€èµ„æº 404ï¼Œæ¨èå°† `/_next/static` ç›´æ¥ alias åˆ°æœåŠ¡å™¨ç›®å½•ï¼š

```nginx
location /_next/static/ {
    alias /var/www/delay.bebackpacker.com/.next/static/;
    expires 1y;
    add_header Cache-Control "public, max-age=31536000, immutable" always;
    access_log off;
}
```

å®Œæ•´æ­¥éª¤è¯¦è§ï¼š`docs/deployment-self-hosted.md`

## ğŸ”‘ ç¯å¢ƒå˜é‡

å‚è§ç¤ºä¾‹æ–‡ä»¶ï¼š`.env.example`

- å¿…éœ€
  - `NEXT_PUBLIC_APP_NAME`ï¼Œ`NEXT_PUBLIC_APP_URL`
  - `NEXT_PUBLIC_DEFAULT_LOCALE`ï¼ˆé»˜è®¤ `zh`ï¼‰
  - `NEXT_PUBLIC_ENV`ï¼ˆ`development`/`production`ï¼‰
  - `DATABASE_URL`ï¼ˆPostgreSQL è¿æ¥ä¸²ï¼Œä»…æœåŠ¡å™¨ç«¯ä½¿ç”¨ï¼‰
  - `PGSSLMODE`ï¼ˆå¯é€‰ï¼Œå¦‚æ•°æ®åº“è¦æ±‚ SSLï¼Œå¯è®¾ä¸º `require`ï¼‰
- å¯é€‰é›†æˆ
  - å¾®ä¿¡ç™»å½•ï¼š`NEXT_PUBLIC_WECHAT_APP_ID`ï¼Œ`WECHAT_APP_SECRET`
  - åˆ†æï¼š`NEXT_PUBLIC_GA_ID`ï¼Œ`NEXT_PUBLIC_VERCEL_ANALYTICS_ID`
  - é”™è¯¯ç›‘æ§ï¼š`NEXT_PUBLIC_SENTRY_DSN`ï¼Œ`SENTRY_AUTH_TOKEN`
  - è¿è¡Œæ¨¡å¼ï¼š`NEXT_PUBLIC_UNIAPP_MODE`

## ğŸŒ å›½é™…åŒ–ï¼ˆi18nï¼‰

- åŸºäº `next-intl`ï¼š`src/lib/i18n/`ï¼ˆé…ç½®ï¼‰
  - `locales: ['zh', 'en']`ï¼Œ`defaultLocale: 'zh'`ï¼Œ`localePrefix: 'always'`
- è¯·æ±‚æœŸè§£æï¼š`src/i18n/request.ts`ï¼Œç¡®ä¿éæ³•æˆ–ç¼ºå¤± locale æ—¶å›é€€åˆ°é»˜è®¤è¯­è¨€
- æ–‡æ¡ˆå­—å…¸ï¼š`/messages/zh.json`ã€`/messages/en.json`

## ğŸ’¾ æ•°æ®å­˜å‚¨ä¸åŒæ­¥

- æœ¬åœ°å­˜å‚¨ï¼ˆIndexedDB via Dexieï¼‰
  - ç»Ÿè®¡ä¸è¿‡æœŸå¤„ç†ã€ç¦»çº¿ä¼˜å…ˆ
- æœåŠ¡å™¨ç«¯ï¼ˆPostgreSQL + pgï¼‰
  - è¿æ¥æ± ï¼š`src/lib/server/db.ts`
  - API è·¯ç”±ï¼š`src/app/[locale]/api/**`ï¼ˆå¦‚ `/api/square/share`ã€`/api/square/comments` ç­‰ï¼‰
  - å‰ç«¯é€šè¿‡ç›¸å¯¹è·¯å¾„è°ƒç”¨ APIï¼›ç¦»çº¿æ—¶å›é€€åˆ°æœ¬åœ°æ•°æ®

### ğŸ”’ æƒé™ä¸å®‰å…¨ï¼ˆSupabaseï¼‰

- è¿ç§»è„šæœ¬ä¸­ RLS å½“å‰ä¸ºå…³é—­çŠ¶æ€ï¼ˆpolicies è¢«æ³¨é‡Šï¼‰ï¼Œä»…ç”¨äºå¼€å‘ä¸æ¼”ç¤ºã€‚
- ç”Ÿäº§ç¯å¢ƒè¯·åŠ¡å¿…å¼€å¯ RLS å¹¶é…ç½®è¡Œçº§è®¿é—®ç­–ç•¥ï¼ˆè§ `docs/supabase-setup.md`ï¼‰ã€‚
- æœåŠ¡ç«¯ç®¡ç†æ“ä½œä½¿ç”¨ `SUPABASE_SERVICE_ROLE_KEY`ï¼Œä¸¥ç¦åœ¨å®¢æˆ·ç«¯æˆ–é™æ€äº§ç‰©ä¸­æš´éœ²ã€‚

## âš™ï¸ é…ç½®è¦ç‚¹

- `next.config.ts`
  - é›†æˆ `next-intl` æ’ä»¶
  - è¿œç¨‹å›¾ç‰‡ç™½åå•ï¼ˆ`api.dicebear.com`ï¼‰
- `tsconfig.json`
  - è·¯å¾„åˆ«åï¼š`@/* -> ./src/*`
- `eslint.config.mjs`
  - åŸºäº Next.js Core Web Vitals ä¸ TypeScript æ¨èè§„åˆ™
- æ ·å¼
  - Tailwind CSS v4ï¼ˆ`@tailwindcss/postcss` + `postcss.config.mjs`ï¼‰

## ğŸ“„ æ–‡æ¡£

- [éœ€æ±‚æ–‡æ¡£](./docs/requirements.md)
- [æŠ€æœ¯æ–‡æ¡£](./docs/technical.md)
- [ä»»åŠ¡è§„åˆ’](./docs/tasks.md)
- [ç¯å¢ƒæ­å»º](./docs/environment-setup.md)
- [Supabase é…ç½®ä¸æƒé™](./docs/supabase-setup.md)
- [è‡ªå»ºéƒ¨ç½²æŒ‡å—](./docs/deployment-self-hosted.md)
- [Vercel éƒ¨ç½²æŒ‡å—](./docs/vercel-deployment.md)
- [Uniapp X é›†æˆ](./docs/uniapp-x-integration.md)

---

## ğŸ‡¬ğŸ‡§ English Version (Brief)

- Overview: A playful task manager for procrastinators. Write excuses, track delays, and sometimes go â€œRage Modeâ€.
- Tech Stack: Next.js 15.5.2, React 19.1.0, TypeScript 5.9, Tailwind v4, next-intl 4, Supabase 2, Dexie 4, Zustand 5, Radix/shadcn-style UI, TanStack Query 5.
- Quick Start: `npm i` â†’ `npm run dev` â†’ open http://localhost:3000.
- Env Vars: Supabase URL/Anon Key (required), Service Role (server only), App name/URL, Default locale, WeChat/Analytics/Sentry (optional).
- i18n: next-intl with locales `zh`/`en`, default `zh`, locale prefix always.
- Data & Sync: Dexie (local), SyncManager (5-min polling, offline queue) + Supabase (cloud). Task scheduler checks overdue tasks every 30 min and on visibility change.
- Docs: See `/docs/*` for detailed setup and deployment.

## ğŸ“„ è®¸å¯è¯

MIT License